<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base" content="https://blackheaven.github.io">

    
    <title>Gautier DI FOLCO • Extreme branchless: Game of Life</title>

    
    
        <link rel="icon" type="image/png" href="https://blackheaven.github.io/favicon-16x16.png"/>
    
    

    
    
        
            
            
                
                    <link rel="alternate" type="application/atom+xml" title="Gautier DI FOLCO - Atom Feed" href="https://blackheaven.github.io/atom.xml">
                
            
        
    

    
    
    
        <link rel="stylesheet" href="https://blackheaven.github.io/inter_subset_en.css?h=d8cf4ad058d6c3a4015b">
    

    
        <link rel="stylesheet" href="https://blackheaven.github.io/main.css?h=4709f1203e8bd6b4162f" />
        <link rel="stylesheet" href="https://blackheaven.github.io/skins/blue.css?h=a4dc1e94d3f5759784d2" />

    <meta name="color-scheme" content="dark" />
        <meta name="description" content="A software engineer website" />
        <meta property="og:description" content="A software engineer website" />

    
        <meta name="robots" content="index, nofollow" />
    

    <meta property="og:title" content="Extreme branchless: Game of Life" />
    <meta property="og:type" content="article" />

    

    <meta property="og:locale" content="en_GB" />

    <meta property="og:url" content="https:&#x2F;&#x2F;blackheaven.github.io&#x2F;2024-11&#x2F;extreme-branchless-gol&#x2F;" /><meta property="og:site_name" content="Gautier DI FOLCO"><meta http-equiv="Content-Security-Policy"
content="default-src 'self';font-src &#x27;self&#x27; data: 'self';img-src &#x27;self&#x27; https:&#x2F;&#x2F;* data:;media-src &#x27;self&#x27;;style-src &#x27;self&#x27; 'unsafe-inline';frame-src player.vimeo.com https:&#x2F;&#x2F;www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'">
<script defer src="https://blackheaven.github.io/search_index.en.js?h=9ff10f9e8fb83581467d"></script>
        <script defer src="https://blackheaven.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e"></script>

        </head>


<body>
    <header>
    <nav class="navbar">
        <div class="nav-title">
            <a class="home-title" href="https://blackheaven.github.io">Gautier DI FOLCO</a>
        </div>
            <div class="nav-navs">
                <ul>
                        
                            <li>
                                
                                <a class="nav-links no-hover-padding" href="https://blackheaven.github.io/foss/">
                                FOSS Contributions
                                </a>
                            </li>
                        
                            <li>
                                
                                <a class="nav-links no-hover-padding" href="https://blackheaven.github.io/activities/">
                                Activities
                                </a>
                            </li>
                        
                            <li>
                                
                                <a class="nav-links no-hover-padding" href="https://blackheaven.github.io/hiring/">
                                Hire me
                                </a>
                            </li>
                        
                            <li>
                                
                                <a class="nav-links no-hover-padding" href="https://blackheaven.github.io/talks/">
                                Talks
                                </a>
                            </li>
                        
                            <li>
                                
                                <a class="nav-links no-hover-padding" href="https://blackheaven.github.io/blog/">
                                Posts
                                </a>
                            </li>
                        
                            <li>
                                
                                <a class="nav-links no-hover-padding" href="https://blackheaven.github.io/categories/">
                                Categories
                                </a>
                            </li>
                        
                            <li>
                                
                                <a class="nav-links no-hover-padding" href="https://blackheaven.github.io/tags/">
                                Tags
                                </a>
                            </li>
                        <div class="nav-navs" id="menu-icons-group">
                        <li class="js">
                            <div role="button" tabindex="0" id="search-button" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" aria-label="Click or press $SHORTCUT to open search">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                    <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
                                </svg>
                            </div>
                        </li>

                        
                        

                        </div>
                </ul>
            </div>
        
    </nav>
</header>

    <div class="content">

        
        




<main>
    <article>
        <h1 class="article-title">
            Extreme branchless: Game of Life
        </h1>

        <ul class="meta">
                <li>26th Nov 2024</li>
                <li title="475 words"><span class='separator' aria-hidden='true'>•</span>3 min read</li><li class="tag"><span class='separator' aria-hidden='true'>•</span>Tags:&nbsp;</li><li class="tag"><a href="https://blackheaven.github.io/tags/haskell/">haskell</a>,&nbsp;</li><li class="tag"><a href="https://blackheaven.github.io/tags/code-kata/">code kata</a>,&nbsp;</li><li class="tag"><a href="https://blackheaven.github.io/tags/coding-dojo/">coding dojo</a>,&nbsp;</li><li class="tag"><a href="https://blackheaven.github.io/tags/functional-programming/">functional programming</a></li>
        </ul>

        <section class="body"><p>In my <a href="https://blackheaven.github.io/2024-11/gdcr-summary/">GDCR Summary</a>, I have mentioned a <a href="https://blackheaven.github.io/2024-11/extreme-branchless-2/">branchless</a>
of the game of life kata.</p>
<p>This logs attempts to present my solution.</p>
<p>First thing first, we have a <code>Cell</code> which can be either <code>Dead</code> or <code>Alive</code>.</p>
<p>With our previously defined framework it gives the following definition:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-keyword z-other z-haskell">newtype</span> <span class="z-constant z-other z-haskell">Cell</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Cell</span> (forall a<span class="z-keyword z-operator z-haskell">.</span> a <span class="z-keyword z-operator z-haskell">-&gt;</span> a <span class="z-keyword z-operator z-haskell">-&gt;</span> a)
</span></code></pre>
<p>Then we can add few helpers:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-meta z-declaration z-instance z-haskell"><span class="z-keyword z-other z-haskell">instance</span> <span class="z-storage z-type z-haskell">Show</span> <span class="z-storage z-type z-haskell">Cell</span> <span class="z-keyword z-other z-haskell">where</span></span>
</span><span class="z-source z-haskell">  show <span class="z-keyword z-operator z-haskell">=</span> runCell <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Alive<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Dead<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-declaration z-instance z-haskell"><span class="z-keyword z-other z-haskell">instance</span> <span class="z-storage z-type z-haskell">Eq</span> <span class="z-storage z-type z-haskell">Cell</span> <span class="z-keyword z-other z-haskell">where</span></span>
</span><span class="z-source z-haskell">  <span class="z-entity z-name z-function z-infix z-haskell">(==)</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-entity z-name z-function z-infix z-haskell">(==)</span> <span class="z-keyword z-operator z-function z-infix z-haskell"><span class="z-punctuation z-definition z-entity z-haskell">`</span>on<span class="z-punctuation z-definition z-entity z-haskell">`</span></span> runCell <span class="z-constant z-other z-haskell">True</span> <span class="z-constant z-other z-haskell">False</span>
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">runCell</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-variable z-other z-generic-type z-haskell">a</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-variable z-other z-generic-type z-haskell">a</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-storage z-type z-haskell">Cell</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-variable z-other z-generic-type z-haskell">a</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>runCell a d (<span class="z-constant z-other z-haskell">Cell</span> f) <span class="z-keyword z-operator z-haskell">=</span> f a d
</span></code></pre>
<p>And finally define <code>dead</code>/<code>alive</code>:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">alive</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Cell</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>alive <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Cell</span> <span class="z-keyword z-operator z-haskell">$</span> <span class="z-keyword z-operator z-haskell">\</span>x _ <span class="z-keyword z-operator z-haskell">-&gt;</span> x
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">dead</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Cell</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>dead <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Cell</span> <span class="z-keyword z-operator z-haskell">$</span> <span class="z-keyword z-operator z-haskell">\</span>_ x <span class="z-keyword z-operator z-haskell">-&gt;</span> x
</span></code></pre>
<p>Then we have to think a bit.</p>
<p>The game of life comes with the following rules:</p>
<ul>
<li>A living cell with less than 2 living neighbours die</li>
<li>A living cell with more than 3 living neighbours die</li>
<li>A living cell with 2 or three living neighbours live</li>
<li>A dead cell with three living neighbours becomes alive</li>
</ul>
<p>Let's see how it goes in a table:</p>
<table><thead><tr><th>Number of living neighbours / Initial state</th><th>Dead</th><th>Alive</th></tr></thead><tbody>
<tr><td>&lt; 2</td><td>Dead</td><td>Dead</td></tr>
<tr><td>2</td><td>Dead</td><td>Alive</td></tr>
<tr><td>3</td><td>Alive</td><td>Alive</td></tr>
<tr><td>&gt; 3</td><td>Dead</td><td>Dead</td></tr>
</tbody></table>
<p>Taking the number of living neighbours as main inputs helps us to pick
a <code>Strategy</code> which could be represented as:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-keyword z-other z-haskell">newtype</span> <span class="z-constant z-other z-haskell">Strategy</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Strategy</span>
</span><span class="z-source z-haskell">  { envolve <span class="z-keyword z-operator z-haskell">::</span> <span class="z-constant z-other z-haskell">Cell</span> <span class="z-keyword z-operator z-haskell">-&gt;</span> <span class="z-constant z-other z-haskell">Cell</span>
</span><span class="z-source z-haskell">  }
</span></code></pre>
<p>We should improve it, especially because at some point, we would need to count
the neighbours, as we have seen in the previous log, the best way to deal with
numbers is to use <a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Church_encoding">Church encoding</a>.</p>
<p>To do so, each <code>Strategy</code> should be able to know the next <code>Strategy</code>, the <code>Strategy</code>
with one more living neighbours (it's closed to OOP's <a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Chain-of-responsibility_pattern">Chain of responsibility</a> design pattern):</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-keyword z-other z-haskell">data</span> <span class="z-constant z-other z-haskell">Strategy</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Strategy</span>
</span><span class="z-source z-haskell">  { name <span class="z-keyword z-operator z-haskell">::</span> <span class="z-constant z-other z-haskell">String</span>
</span><span class="z-source z-haskell">  <span class="z-punctuation z-separator z-comma z-haskell">,</span> envolve <span class="z-keyword z-operator z-haskell">::</span> <span class="z-constant z-other z-haskell">Cell</span> <span class="z-keyword z-operator z-haskell">-&gt;</span> <span class="z-constant z-other z-haskell">Cell</span>
</span><span class="z-source z-haskell">  <span class="z-punctuation z-separator z-comma z-haskell">,</span> nextStrategy <span class="z-keyword z-operator z-haskell">::</span> <span class="z-constant z-other z-haskell">Strategy</span>
</span><span class="z-source z-haskell">  }
</span></code></pre>
<p>Then, we can define the strategies according to our table:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">starvation0</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Strategy</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>starvation0 <span class="z-keyword z-operator z-haskell">=</span>
</span><span class="z-source z-haskell">  <span class="z-constant z-other z-haskell">Strategy</span> {
</span><span class="z-source z-haskell">    name <span class="z-keyword z-operator z-haskell">=</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Starving<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    envolve <span class="z-keyword z-operator z-haskell">=</span> const dead<span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    nextStrategy <span class="z-keyword z-operator z-haskell">=</span> starvation1
</span><span class="z-source z-haskell">  }
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">starvation1</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Strategy</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>starvation1 <span class="z-keyword z-operator z-haskell">=</span>
</span><span class="z-source z-haskell">  <span class="z-constant z-other z-haskell">Strategy</span> {
</span><span class="z-source z-haskell">    name <span class="z-keyword z-operator z-haskell">=</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Starving<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    envolve <span class="z-keyword z-operator z-haskell">=</span> const dead<span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    nextStrategy <span class="z-keyword z-operator z-haskell">=</span> equilibrium
</span><span class="z-source z-haskell">  }
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">equilibrium</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Strategy</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>equilibrium <span class="z-keyword z-operator z-haskell">=</span>
</span><span class="z-source z-haskell">  <span class="z-constant z-other z-haskell">Strategy</span> {
</span><span class="z-source z-haskell">    name <span class="z-keyword z-operator z-haskell">=</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Equilibrium<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    envolve <span class="z-keyword z-operator z-haskell">=</span> id<span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    nextStrategy <span class="z-keyword z-operator z-haskell">=</span> reproduction
</span><span class="z-source z-haskell">  }
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">reproduction</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Strategy</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>reproduction <span class="z-keyword z-operator z-haskell">=</span>
</span><span class="z-source z-haskell">  <span class="z-constant z-other z-haskell">Strategy</span> {
</span><span class="z-source z-haskell">    name <span class="z-keyword z-operator z-haskell">=</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Reproduction<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    envolve <span class="z-keyword z-operator z-haskell">=</span> const alive<span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    nextStrategy <span class="z-keyword z-operator z-haskell">=</span> overpopulation
</span><span class="z-source z-haskell">  }
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">overpopulation</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Strategy</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>overpopulation <span class="z-keyword z-operator z-haskell">=</span>
</span><span class="z-source z-haskell">  <span class="z-constant z-other z-haskell">Strategy</span> {
</span><span class="z-source z-haskell">    name <span class="z-keyword z-operator z-haskell">=</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Overpopulation<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    envolve <span class="z-keyword z-operator z-haskell">=</span> const dead<span class="z-punctuation z-separator z-comma z-haskell">,</span>
</span><span class="z-source z-haskell">    nextStrategy <span class="z-keyword z-operator z-haskell">=</span> overpopulation
</span><span class="z-source z-haskell">  }
</span></code></pre>
<p>Note:</p>
<ul>
<li><code>const x</code> returns a function which always returns <code>x</code>, whatever the input is</li>
<li><code>id</code>, is the identity function, returning the given parameter</li>
</ul>
<p>It looks like this:</p>


<noscript>
    <strong>⚠️ JavaScript is required to render the diagram.</strong>
</noscript>
<pre class="mermaid invertible-image">
    graph LR;
    starvation0 --> starvation1;
    starvation1 --> equilibrium;
    equilibrium --> reproduction;
    reproduction --> overpopulation;
    overpopulation --> overpopulation;
</pre>
<p>Then we need a way to evolve a whole grid.</p>
<p>There are several ways to represent a grid, I have chosen a <code>Set Position</code>,
which represents the living cells:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-keyword z-other z-haskell">type</span> <span class="z-constant z-other z-haskell">Position</span> <span class="z-keyword z-operator z-haskell">=</span> (<span class="z-constant z-other z-haskell">Int</span><span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">Int</span>)
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">envolveGrid</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Set</span>.<span class="z-storage z-type z-haskell">Set</span> <span class="z-storage z-type z-haskell">Position</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-storage z-type z-haskell">Set</span>.<span class="z-storage z-type z-haskell">Set</span> <span class="z-storage z-type z-haskell">Position</span>
</span></span></code></pre>
<p>The approach is straightforward:</p>
<ul>
<li>For each living cell: list their neighbours</li>
<li>For each neighbours count their neighbours and select the correct <code>Strategy</code></li>
<li>Give to the <code>Strategy</code> the current neighbour state</li>
</ul>
<p>Which gives:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">envolveGrid</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Set</span>.<span class="z-storage z-type z-haskell">Set</span> <span class="z-storage z-type z-haskell">Position</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-storage z-type z-haskell">Set</span>.<span class="z-storage z-type z-haskell">Set</span> <span class="z-storage z-type z-haskell">Position</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>envolveGrid initialAliveCells <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Set</span><span class="z-keyword z-operator z-haskell">.</span>filter isAliveEnvolved <span class="z-keyword z-operator z-haskell">$</span> foldMap listNeighbours initialAliveCells
</span><span class="z-source z-haskell">  <span class="z-keyword z-other z-haskell">where</span> isAliveEnvolved <span class="z-keyword z-operator z-haskell">::</span> <span class="z-constant z-other z-haskell">Position</span> <span class="z-keyword z-operator z-haskell">-&gt;</span> <span class="z-constant z-other z-haskell">Bool</span>
</span><span class="z-source z-haskell">        isAliveEnvolved pos <span class="z-keyword z-operator z-haskell">=</span> runCell <span class="z-constant z-other z-haskell">True</span> <span class="z-constant z-other z-haskell">False</span> <span class="z-keyword z-operator z-haskell">$</span> (selectStrategy pos)<span class="z-keyword z-operator z-haskell">.</span>envolve <span class="z-keyword z-operator z-haskell">$</span> isAlive pos alive dead
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell">        <span class="z-entity z-name z-function z-haskell">isAlive</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Position</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-variable z-other z-generic-type z-haskell">a</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-variable z-other z-generic-type z-haskell">a</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-variable z-other z-generic-type z-haskell">a</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>        isAlive pos whenAlive whenDead <span class="z-keyword z-operator z-haskell">=</span> thenElseIf whenAlive whenDead <span class="z-keyword z-operator z-haskell">$</span> toBool&#39; <span class="z-keyword z-operator z-haskell">$</span> <span class="z-constant z-other z-haskell">Set</span><span class="z-keyword z-operator z-haskell">.</span>member pos initialAliveCells
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell">        <span class="z-entity z-name z-function z-haskell">selectStrategy</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Position</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-storage z-type z-haskell">Strategy</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>        selectStrategy <span class="z-keyword z-operator z-haskell">=</span> foldl (<span class="z-keyword z-operator z-haskell">\</span>acc cell <span class="z-keyword z-operator z-haskell">-&gt;</span> isAlive cell (<span class="z-keyword z-operator z-haskell">.</span>nextStrategy) id acc) starvation0 <span class="z-keyword z-operator z-haskell">.</span> listNeighbours
</span><span class="z-source z-haskell">        listNeighbours (x<span class="z-punctuation z-separator z-comma z-haskell">,</span> y) <span class="z-keyword z-operator z-haskell">=</span>
</span><span class="z-source z-haskell">          <span class="z-constant z-other z-haskell">Set</span><span class="z-keyword z-operator z-haskell">.</span>fromList [
</span><span class="z-source z-haskell">            (x <span class="z-keyword z-operator z-haskell">+</span> xDiff<span class="z-punctuation z-separator z-comma z-haskell">,</span> y <span class="z-keyword z-operator z-haskell">+</span> yDiff)
</span><span class="z-source z-haskell">            <span class="z-keyword z-operator z-haskell">|</span> xDiff <span class="z-keyword z-operator z-haskell">&lt;-</span> [<span class="z-keyword z-operator z-haskell">-</span><span class="z-constant z-numeric z-integer z-decimal z-haskell">1</span> <span class="z-keyword z-operator z-haskell">..</span> <span class="z-constant z-numeric z-integer z-decimal z-haskell">1</span>]
</span><span class="z-source z-haskell">            <span class="z-punctuation z-separator z-comma z-haskell">,</span> yDiff <span class="z-keyword z-operator z-haskell">&lt;-</span> [<span class="z-keyword z-operator z-haskell">-</span><span class="z-constant z-numeric z-integer z-decimal z-haskell">1</span> <span class="z-keyword z-operator z-haskell">..</span> <span class="z-constant z-numeric z-integer z-decimal z-haskell">1</span>]
</span><span class="z-source z-haskell">            <span class="z-punctuation z-separator z-comma z-haskell">,</span> xDiff <span class="z-keyword z-operator z-haskell">/=</span> <span class="z-constant z-numeric z-integer z-decimal z-haskell">0</span> <span class="z-keyword z-operator z-haskell">||</span> yDiff <span class="z-keyword z-operator z-haskell">/=</span> <span class="z-constant z-numeric z-integer z-decimal z-haskell">0</span>
</span><span class="z-source z-haskell">          ]
</span></code></pre>
<p>Notes:</p>
<ul>
<li><code>foldMap listNeighbours initialAliveCells</code> collects all neighbours</li>
<li><code>Set.filter isAliveEnvolved</code> keep only <code>Cell</code> still alive in next generation</li>
<li><code>isAliveEnvolved</code> apply the selected <code>Strategy</code> with current neighbour's state and convert it to <code>Bool</code> for <code>filter</code></li>
<li><code>isAlive</code> check if a cell is alive in the current grid, there's much boilerplate because I use the usual <code>Set</code>, I have to cheat a bit here</li>
<li><code>selectStrategy</code> list the potential neighbours and on them, starting from a 0-neighbour strategy, for each <code>Position</code>, if the <code>Cell</code> is dead, we keep the current <code>Strategy</code>, otherwise, pick the <code>nextStrategy</code></li>
<li><code>listNeighbours</code> generates <code>+1</code>/<code>-1</code> <code>Position</code></li>
</ul>


<noscript>
    <strong>⚠️ JavaScript is required to render the diagram.</strong>
</noscript>
<pre class="mermaid invertible-image">
    graph TD;
    Position -- is alive --> nextStrategy
    Position -- is dead --> id
</pre>
<p>And that's it.</p>
<p>Note: here's my <code>Bool'</code> wrapper:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-keyword z-other z-haskell">newtype</span> <span class="z-constant z-other z-haskell">Bool</span>&#39; <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Bool</span>&#39; (forall a<span class="z-keyword z-operator z-haskell">.</span> a <span class="z-keyword z-operator z-haskell">-&gt;</span> a <span class="z-keyword z-operator z-haskell">-&gt;</span> a)
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-declaration z-instance z-haskell"><span class="z-keyword z-other z-haskell">instance</span> <span class="z-storage z-type z-haskell">Show</span> <span class="z-storage z-type z-haskell">Bool</span>&#39; <span class="z-keyword z-other z-haskell">where</span></span>
</span><span class="z-source z-haskell">  show <span class="z-keyword z-operator z-haskell">=</span> thenElseIf <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>True<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>False<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-declaration z-instance z-haskell"><span class="z-keyword z-other z-haskell">instance</span> <span class="z-storage z-type z-haskell">Eq</span> <span class="z-storage z-type z-haskell">Bool</span>&#39; <span class="z-keyword z-other z-haskell">where</span></span>
</span><span class="z-source z-haskell">  <span class="z-entity z-name z-function z-infix z-haskell">(==)</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-entity z-name z-function z-infix z-haskell">(==)</span> <span class="z-keyword z-operator z-function z-infix z-haskell"><span class="z-punctuation z-definition z-entity z-haskell">`</span>on<span class="z-punctuation z-definition z-entity z-haskell">`</span></span> thenElseIf <span class="z-constant z-other z-haskell">True</span> <span class="z-constant z-other z-haskell">False</span>
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">thenElseIf</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-variable z-other z-generic-type z-haskell">a</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-variable z-other z-generic-type z-haskell">a</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-storage z-type z-haskell">Bool</span>&#39; <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-variable z-other z-generic-type z-haskell">a</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>thenElseIf t f (<span class="z-constant z-other z-haskell">Bool</span>&#39; g) <span class="z-keyword z-operator z-haskell">=</span> g t f
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">toBool&#39;</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Bool</span> <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-storage z-type z-haskell">Bool</span>&#39;
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>toBool&#39; x <span class="z-keyword z-operator z-haskell">=</span> <span class="z-keyword z-control z-haskell">if</span> x <span class="z-keyword z-control z-haskell">then</span> true <span class="z-keyword z-control z-haskell">else</span> false
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">true</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Bool</span>&#39;
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>true <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Bool</span>&#39; <span class="z-keyword z-operator z-haskell">$</span> <span class="z-keyword z-operator z-haskell">\</span>x _ <span class="z-keyword z-operator z-haskell">-&gt;</span> x
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">false</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Bool</span>&#39;
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>false <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Bool</span>&#39; <span class="z-keyword z-operator z-haskell">$</span> <span class="z-keyword z-operator z-haskell">\</span>_ x <span class="z-keyword z-operator z-haskell">-&gt;</span> x
</span></code></pre>

        </section>

        
        
        

        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
        

    </article>
</main>


<script defer src="https://blackheaven.github.io/js/mermaid.min.js"></script><span id="copy-success" class="hidden">
        Copied!
    </span>
    <span id="copy-init" class="hidden">
        Copy code to clipboard
    </span>
    <script defer src="https://blackheaven.github.io/js/copyCodeToClipboard.min.js"></script>
    </div>
    <footer>
    <section>
        <nav class="socials nav-navs">
                <ul>
                    
                    
                    
                    <li>
                        <a class="nav-links no-hover-padding social" rel="noopener" target=_blank href="https://blackheaven.github.io/atom.xml">
                        <img loading="lazy" alt="feed" title="feed" src="https://blackheaven.github.io/social_icons/rss.svg">
                        </a>
                    </li><li class="js"><a class="nav-links no-hover-padding social" href="#" data-encoded-email="Z2F1dGllci5kaWZvbCtibG9nQGdtYWlsLmNvbQ=="><img loading="lazy" alt="email" title="email" src="https://blackheaven.github.io/social_icons/email.svg">
                            </a>
                        </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel="noopener me" target=_blank href="https://www.linkedin.com/in/gautier-di-folco/">
                                    <img loading="lazy" alt="linkedin" title="linkedin" src="https://blackheaven.github.io/social_icons/linkedin.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel="noopener me" target=_blank href="https://github.com/blackheaven/">
                                    <img loading="lazy" alt="github" title="github" src="https://blackheaven.github.io/social_icons/github.svg">
                                </a>
                            </li>
                        
                    
                </ul>
            
        </nav>

        
        <nav class="nav-navs">
        </nav>

        <div class="credits">
            <small>
                

                
                Powered by
                <a rel="noopener" target=_blank href="https://www.getzola.org">Zola</a>
                &amp;
                <a rel="noopener" target=_blank href="https://github.com/welpo/tabi">tabi</a>

                </small>
        </div>
    </section>

    <script src="https://blackheaven.github.io/js/decodeMail.min.js" async></script><div id="searchModal" class="search-modal js" role="dialog" aria-labelledby="modalTitle">
    <h1 id="modalTitle" class="visually-hidden">Search</h1>
    <div id="modal-content">
        <div id="searchBar">
            <div class="search-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                    <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
                </svg>
            </div>
            <input id="searchInput" role="combobox" autocomplete="off" spellcheck="false" aria-expanded="false" aria-controls="results-container" placeholder="Search…"/>
            <div id="clear-search" class="close-icon interactive-icon" tabindex="0" role="button" title="Clear search">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                <path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/>
                </svg>
            </div>
        </div>
        <div id="results-container">
            <div id="results-info"><span id="zero_results"> No results</span>
                <span id="one_results"> $NUMBER result</span>
                <span id="many_results"> $NUMBER results</span><span id="two_results"> $NUMBER results</span>
                <span id="few_results"> $NUMBER results</span>
            </div>
            <div id="results" role="listbox"></div>
        </div>
    </div>
</div>
</footer>

</body>

</html>
